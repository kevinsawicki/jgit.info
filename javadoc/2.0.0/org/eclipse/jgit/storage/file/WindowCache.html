<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_21) on Mon Jun 25 17:59:36 EDT 2012 -->
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>
WindowCache (JGit - Core 2.0.0.201206130900-r API)
</TITLE>

<META NAME="date" CONTENT="2012-06-25">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="WindowCache (JGit - Core 2.0.0.201206130900-r API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

<script type="text/javascript"> 
var _gauges = _gauges || []; 
(function() { 
  var t   = document.createElement('script'); 
  t.type  = 'text/javascript'; 
  t.async = true; 
  t.id    = 'gauges-tracker'; 
  t.setAttribute('data-site-id', '4f18d245844d52260f00000e'); 
  t.src = '//secure.gaug.es/track.js'; 
  var s = document.getElementsByTagName('script')[0]; 
  s.parentNode.insertBefore(t, s); 
})(); 
</script> 
</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/WindowCache.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../org/eclipse/jgit/storage/file/UnpackedObject.html" title="class in org.eclipse.jgit.storage.file"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCacheConfig.html" title="class in org.eclipse.jgit.storage.file"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?org/eclipse/jgit/storage/file/WindowCache.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="WindowCache.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.eclipse.jgit.storage.file</FONT>
<BR>
Class WindowCache</H2>
<PRE>
<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../../../resources/inherit.gif" ALT="extended by "><B>org.eclipse.jgit.storage.file.WindowCache</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>WindowCache</B><DT>extends <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></DL>
</PRE>

<P>
Caches slices of a <A HREF="../../../../../org/eclipse/jgit/storage/file/PackFile.html" title="class in org.eclipse.jgit.storage.file"><CODE>PackFile</CODE></A> in memory for faster read access.
 <p>
 The WindowCache serves as a Java based "buffer cache", loading segments of a
 PackFile into the JVM heap prior to use. As JGit often wants to do reads of
 only tiny slices of a file, the WindowCache tries to smooth out these tiny
 reads into larger block-sized IO operations.
 <p>
 Whenever a cache miss occurs, <A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCache.html#load(org.eclipse.jgit.storage.file.PackFile, long)"><CODE>load(PackFile, long)</CODE></A> is invoked by
 exactly one thread for the given <code>(PackFile,position)</code> key tuple.
 This is ensured by an array of locks, with the tuple hashed to a lock
 instance.
 <p>
 During a miss, older entries are evicted from the cache so long as
 <A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCache.html#isFull()"><CODE>isFull()</CODE></A> returns true.
 <p>
 Its too expensive during object access to be 100% accurate with a least
 recently used (LRU) algorithm. Strictly ordering every read is a lot of
 overhead that typically doesn't yield a corresponding benefit to the
 application.
 <p>
 This cache implements a loose LRU policy by randomly picking a window
 comprised of roughly 10% of the cache, and evicting the oldest accessed entry
 within that window.
 <p>
 Entities created by the cache are held under SoftReferences, permitting the
 Java runtime's garbage collector to evict entries when heap memory gets low.
 Most JREs implement a loose least recently used algorithm for this eviction.
 <p>
 The internal hash table does not expand at runtime, instead it is fixed in
 size at cache creation time. The internal lock table used to gate load
 invocations is also fixed in size.
 <p>
 The key tuple is passed through to methods as a pair of parameters rather
 than as a single Object, thus reducing the transient memory allocations of
 callers. It is more efficient to avoid the allocation, as we can't be 100%
 sure that a JIT would be able to stack-allocate a key tuple.
 <p>
 This cache has an implementation rule such that:
 <ul>
 <li><A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCache.html#load(org.eclipse.jgit.storage.file.PackFile, long)"><CODE>load(PackFile, long)</CODE></A> is invoked by at most one thread at a time
 for a given <code>(PackFile,position)</code> tuple.</li>
 <li>For every <code>load()</code> invocation there is exactly one
 <A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCache.html#createRef(org.eclipse.jgit.storage.file.PackFile, long, org.eclipse.jgit.storage.file.ByteWindow)"><CODE>createRef(PackFile, long, ByteWindow)</CODE></A> invocation to wrap a
 SoftReference around the cached entity.</li>
 <li>For every Reference created by <code>createRef()</code> there will be
 exactly one call to <A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCache.html#clear(org.eclipse.jgit.storage.file.WindowCache.Ref)"><CODE>clear(Ref)</CODE></A> to cleanup any resources associated
 with the (now expired) cached entity.</li>
 </ul>
 <p>
 Therefore, it is safe to perform resource accounting increments during the
 <A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCache.html#load(org.eclipse.jgit.storage.file.PackFile, long)"><CODE>load(PackFile, long)</CODE></A> or
 <A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCache.html#createRef(org.eclipse.jgit.storage.file.PackFile, long, org.eclipse.jgit.storage.file.ByteWindow)"><CODE>createRef(PackFile, long, ByteWindow)</CODE></A> methods, and matching
 decrements during <A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCache.html#clear(org.eclipse.jgit.storage.file.WindowCache.Ref)"><CODE>clear(Ref)</CODE></A>. Implementors may need to override
 <A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCache.html#createRef(org.eclipse.jgit.storage.file.PackFile, long, org.eclipse.jgit.storage.file.ByteWindow)"><CODE>createRef(PackFile, long, ByteWindow)</CODE></A> in order to embed additional
 accounting information into an implementation specific <CODE>Ref</CODE> subclass,
 as the cached entity may have already been evicted by the JRE's garbage
 collector.
 <p>
 To maintain higher concurrency workloads, during eviction only one thread
 performs the eviction work, while other threads can continue to insert new
 objects in parallel. This means that the cache can be temporarily over limit,
 especially if the nominated eviction thread is being starved relative to the
 other threads.
<P>

<P>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCache.html#reconfigure(int, int, boolean, int)">reconfigure</A></B>(int&nbsp;packedGitLimit,
            int&nbsp;packedGitWindowSize,
            boolean&nbsp;packedGitMMAP,
            int&nbsp;deltaBaseCacheLimit)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>Deprecated.</B>&nbsp;<I>Use <A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCacheConfig.html" title="class in org.eclipse.jgit.storage.file"><CODE>WindowCacheConfig</CODE></A> instead.</I></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCache.html#reconfigure(org.eclipse.jgit.storage.file.WindowCacheConfig)">reconfigure</A></B>(<A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCacheConfig.html" title="class in org.eclipse.jgit.storage.file">WindowCacheConfig</A>&nbsp;cfg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Modify the configuration of the window cache.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="reconfigure(int, int, boolean, int)"><!-- --></A><H3>
reconfigure</H3>
<PRE>
public static void <B>reconfigure</B>(int&nbsp;packedGitLimit,
                               int&nbsp;packedGitWindowSize,
                               boolean&nbsp;packedGitMMAP,
                               int&nbsp;deltaBaseCacheLimit)</PRE>
<DL>
<DD><B>Deprecated.</B>&nbsp;<I>Use <A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCacheConfig.html" title="class in org.eclipse.jgit.storage.file"><CODE>WindowCacheConfig</CODE></A> instead.</I>
<P>
<DD>Modify the configuration of the window cache.
 <p>
 The new configuration is applied immediately. If the new limits are
 smaller than what what is currently cached, older entries will be purged
 as soon as possible to allow the cache to meet the new limit.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>packedGitLimit</CODE> - maximum number of bytes to hold within this instance.<DD><CODE>packedGitWindowSize</CODE> - number of bytes per window within the cache.<DD><CODE>packedGitMMAP</CODE> - true to enable use of mmap when creating windows.<DD><CODE>deltaBaseCacheLimit</CODE> - number of bytes to hold in the delta base cache.</DL>
</DD>
</DL>
<HR>

<A NAME="reconfigure(org.eclipse.jgit.storage.file.WindowCacheConfig)"><!-- --></A><H3>
reconfigure</H3>
<PRE>
public static void <B>reconfigure</B>(<A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCacheConfig.html" title="class in org.eclipse.jgit.storage.file">WindowCacheConfig</A>&nbsp;cfg)</PRE>
<DL>
<DD>Modify the configuration of the window cache.
 <p>
 The new configuration is applied immediately. If the new limits are
 smaller than what what is currently cached, older entries will be purged
 as soon as possible to allow the cache to meet the new limit.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>cfg</CODE> - the new window cache configuration.
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - the cache configuration contains one or more invalid
             settings, usually too low of a limit.</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/WindowCache.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../org/eclipse/jgit/storage/file/UnpackedObject.html" title="class in org.eclipse.jgit.storage.file"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../org/eclipse/jgit/storage/file/WindowCacheConfig.html" title="class in org.eclipse.jgit.storage.file"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?org/eclipse/jgit/storage/file/WindowCache.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="WindowCache.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &#169; 2012. All Rights Reserved.
</BODY>
</HTML>
